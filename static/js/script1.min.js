$.fn.extend({animateCss:function(b,a){this.addClass("animated "+b);this.one("animationend",function(c){$(this).removeClass("animated "+b);if(a){a()}});return this}});$(document).ready(function(){$(".search-form").on("submit",function(f){f.preventDefault();$search_mode=$("#search-mode");console.log($search_mode);$spinner=$search_mode.find(".js-spinner.product-search-spinner");$spinner.show();var d=$(this).serialize();var c=$(this).attr("action");$search_mode.show();$container=$search_mode.find(".js-results-container");$("#browse-mode").hide();$container.html("");$container.load(c+"?"+d+" #search-results",function(e){b();console.log(e);$spinner.hide();window.history.pushState("object or string","Title",c+"?"+d)})});function a(){$(".product-card-body, .product-link").fancybox({margin:[0,0],animationEffect:"fade",baseClass:"fancybox-overlay js-fix-scroll fancybox-overlay-fixed",btnTpl:{smallBtn:'<a data-fancybox-close class="close-button-base close-button-position-top-right" title="{{CLOSE}}"></a>'},spinnerTpl:'<div id="fancybox-loading"><div id="fancybox-loading-spinner"></div></div>',content:this,afterLoad:function(c){console.log(c);window.history.pushState("object or string","Title",c.current.src)},afterClose:function(){window.history.back()},clickContent:function(f,d){var g=f.opts.$orig.parent();if($(d.target).parents(".CardAction").length||$(d.target).hasClass("CardAction")){d.preventDefault();if($(d.target).parents(".CardAction").length){$btn=$(d.target).parents(".CardAction")}else{$btn=$(d.target)}var c=$btn.attr("href");$.ajax({url:c,contentType:"application/json",success:function(e){console.log(g);if(g.parents(".ProductCard").length){$ico=g.parents(".ProductCard").find(".like-action-link");active_class="is-liked";deactive_class=""}else{active_class="icon-heart-red";deactive_class="icon-heart";$ico=g.find(".like-action-icon")}console.log($ico);$like_count=g.find(".like-action-number");if("added" in e){$btn.addClass("is-liked");$ico.removeClass(deactive_class).addClass(active_class)}else{if("removed" in e){$btn.removeClass("is-liked");$ico.removeClass(active_class).addClass(deactive_class)}}$like_count.text(e.likes_count)}})}}})}function b(){a();$("#items, #search-results").on("click",function(f){console.log("asda");if($(f.target).parents(".like-action-link").length||f.target.className==="like-action-link"){f.preventDefault();console.log("sadas");if(f.target.className==="like-action-link"){$btn=$(f.target)}else{$btn=$(f.target).parents(".like-action-link")}var c=$btn.attr("href");$like_count=$btn.find(".like-action-number");var d="";var g="";if($btn.parents(".ProductCard").length){$ico=$btn;d="is-liked";g=""}else{d="icon-heart-red";g="icon-heart";$ico=$btn.find(".like-action-icon")}console.log($ico);$.ajax({url:c,contentType:"application/json",success:function(e){if("added" in e){$ico.removeClass(g).addClass(d)}else{if("removed" in e){$ico.removeClass(d).addClass(g)}}$like_count.text(e.likes_count)}})}})}b();$("#items, #search-results").on("DOMNodeInserted DOMNodeRemoved",function(c){a()})});