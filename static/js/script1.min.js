$.fn.extend({animateCss:function(b,a){this.addClass("animated "+b);this.one("animationend",function(c){$(this).removeClass("animated "+b);if(a){a()}});return this}});$(document).ready(function(){$loader=$("#loader");$("#modal-window .close").on("click",function(){var b=$(this).parent().parent();b.animateCss("fadeOut",function(){b.removeClass("visible transition")});$("body").removeClass("dimmed");$("#modal-window-content").hide();$("#modal-loader").hide()});$(".search-form").on("submit",function(d){d.preventDefault();var c=$(this).serialize();var b=$(this).attr("action");console.log(b,c);$loader.show();$("#__blaze-root .site-content").load(b+"?"+c+" .site-content",function(){$("#loader").hide();a()})});$("#modal-content, .product-standalone").on("click",function(d){$modal=$(this);var c=d.target;if(c.id=="like-button"||$(c).parents("#like-button").length>0){d.preventDefault();if(c.id=="like-button"){$btn=$(c)}else{$btn=$(c).parents("#like-button")}var b=$btn.attr("href");console.log(b);$.ajax({url:b,contentType:"application/json",success:function(g){$icon=$btn.find(".icon");if("added" in g){$icon.addClass("active")}else{if("removed" in g){$icon.removeClass("active")}}var e=$('.product-grid-link[data-id = "'+$btn.attr("data-id")+'"]').find(".love-this-count");console.log(e);var f=g.likes_count;e.each(function(){$(this).html(""+f)})}})}else{if((c.className.substr("big-related-product")>0||$(c).parent().hasClass("big-related-product"))||(c.className.substr("related-product")>0||$(c).parent().hasClass("related-product"))){d.preventDefault();if(c.className.substr("big-related-product")>0||c.className.substr("related-product")>0){$item=$(c)}else{$item=$(c).parent();console.log($item)}var b=$item.attr("href");$.ajax({url:b,success:function(e){$modal.html(e)},error:function(e){console.log(e);if(e.status==404){alert("Данный товар не найден")}else{if(e.status==500){alert("Извините за временные неудобства, попробуйте позже")}}}})}}});function a(){$("#items").on("click",function(c){console.log(c.target.className);if($(c.target).parents(".amazon-product").length){c.preventDefault();$parent=$(c.target).parents(".product-grid-link");var b=$parent.attr("href");$loader.show();$("#modal-window").addClass("visible transition").animateCss("fadeIn");$.ajax({url:b,success:function(d){$("#modal-content").html(d);$loader.hide();$("body").addClass("dimmed");$("#modal-window-content").show()},error:function(e){console.log(e);if(e.status==404){alert("Данный товар не найден")}else{if(e.status==500){alert("Извините за временные неудобства, попробуйте позже")}}var d=$(this).parent().parent();d.animateCss("fadeOut",function(){d.removeClass("visible transition")});$("body").removeClass("dimmed");$loader.hide()}})}if($(c.target).parents(".like-action-link").length||c.target.className==="like-action-link"){c.preventDefault();if(c.target.className==="like-action-link"){$btn=$(c.target)}else{$btn=$(c.target).parents(".like-action-link")}var b=$btn.attr("href");$ico=$btn.find(".like-action-icon");$like_count=$btn.find(".like-action-number");$.ajax({url:b,contentType:"application/json",success:function(d){if("added" in d){$ico.removeClass("icon-heart").addClass("icon-heart-red")}else{if("removed" in d){$ico.removeClass("icon-heart-red").addClass("icon-heart")}}$like_count.text(d.likes_count)}})}})}$("#loadmore").on("click",function(){});a();$(".search-form input").focus(function(b){$parent=$(this).parent();$parent.addClass("width_100p")});$(".search-form input").focusout(function(){$parent=$(this).parent();$parent.removeClass("width_100p")})});