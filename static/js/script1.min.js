$.fn.extend({animateCss:function(b,a){this.addClass("animated "+b);this.one("animationend",function(c){$(this).removeClass("animated "+b);if(a){a()}});return this}});$(document).ready(function(){$("#modal-window .close").on("click",function(){var a=$(this).parent().parent();a.animateCss("fadeOut",function(){a.removeClass("visible transition")});$("body").removeClass("dimmed")});$("#modal-content").on("click",function(c){$modal=$(this);var b=c.target;if(b.id=="like-button"||$(b).parents("#like-button").length>0){c.preventDefault();if(b.id=="like-button"){$btn=$(b)}else{$btn=$(b).parents("#like-button")}var a=$btn.attr("href");$.ajax({url:a,contentType:"application/json",success:function(f){$icon=$btn.find(".icon");if("added" in f){$icon.addClass("active")}else{if("removed" in f){$icon.removeClass("active")}}var d=$('.product-grid-link[data-id = "'+$btn.attr("data-id")+'"]').find(".love-this-count");console.log(d);var e=f.likes_count;d.each(function(){$(this).html(""+e)})}})}else{if((b.className.substr("big-related-product")>0||$(b).parent().hasClass("big-related-product"))||(b.className.substr("related-product")>0||$(b).parent().hasClass("related-product"))){c.preventDefault();if(b.className.substr("big-related-product")>0||b.className.substr("related-product")){$item=$(b)}else{$item=$(b).parent();console.log($item)}var a=$item.attr("href");$.ajax({url:a,success:function(d){$modal.html(d)},error:function(d){console.log(d);if(d.status==404){alert("Данный товар не найден")}else{if(d.status==500){alert("Извините за временные неудобства, попробуйте позже")}}}})}}});$("#items").on("click",function(b){console.log(b.target);if($(b.target).parents(".product-grid-link")){b.preventDefault();$parent=$(b.target).parents(".product-grid-link");var a=$parent.attr("href");$.ajax({url:a,success:function(c){$("#modal-content").html(c);$("#modal-window").addClass("visible transition").animateCss("fadeIn");$("body").addClass("dimmed")},error:function(c){console.log(c);if(c.status==404){alert("Данный товар не найден")}else{if(c.status==500){alert("Извините за временные неудобства, попробуйте позже")}}}})}})});