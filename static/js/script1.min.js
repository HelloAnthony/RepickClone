$.fn.extend({animateCss:function(b,a){this.addClass("animated "+b);this.one("animationend",function(c){$(this).removeClass("animated "+b);if(a){a()}});return this}});$(document).ready(function(){$(".search-form").on("submit",function(d){d.preventDefault();$search_mode=$("#search-mode");console.log($search_mode);$spinner=$search_mode.find(".js-spinner.product-search-spinner");$spinner.show();var c=$(this).serialize();var b=$(this).attr("action");$search_mode.show();$container=$search_mode.find(".js-results-container");$("#browse-mode").hide();$container.html("");$container.load(b+"?"+c+" #search-results",function(e){a();console.log(e);$spinner.hide();window.history.pushState("object or string","Title",b+"?"+c)})});function a(){var b="";$(".product-card-body").fancybox({margin:[0,0],animationEffect:"fade",baseClass:"fancybox-overlay js-fix-scroll fancybox-overlay-fixed",btnTpl:{smallBtn:'<a data-fancybox-close class="close-button-base close-button-position-top-right" title="{{CLOSE}}"></a>'},touch:{vertical:false,momentum:false},afterLoad:function(c){b=$(c.$lastFocus[0]).parent();window.history.pushState("object or string","Title",c.current.src)},afterClose:function(){window.history.back()},clickContent:function(f,d){if($(d.target).parents(".CardAction").length||$(d.target).hasClass("CardAction")){d.preventDefault();if($(d.target).parents(".CardAction").length){$btn=$(d.target).parents(".CardAction")}else{$btn=$(d.target)}console.log(b);var c=$btn.attr("href");$.ajax({url:c,contentType:"application/json",success:function(e){$ico=b.find(".like-action-icon");$like_count=b.find(".like-action-number");if("added" in e){$btn.addClass("is-liked");$ico.removeClass("icon-heart").addClass("icon-heart-red")}else{if("removed" in e){$btn.removeClass("is-liked");$ico.removeClass("icon-heart-red").addClass("icon-heart")}}$like_count.text(e.likes_count)}})}}});$("#items, #search-results").on("click",function(d){if($(d.target).parents(".like-action-link").length||d.target.className==="like-action-link"){d.preventDefault();if(d.target.className==="like-action-link"){$btn=$(d.target)}else{$btn=$(d.target).parents(".like-action-link")}var c=$btn.attr("href");$ico=$btn.find(".like-action-icon");$like_count=$btn.find(".like-action-number");$.ajax({url:c,contentType:"application/json",success:function(e){if("added" in e){$ico.removeClass("icon-heart").addClass("icon-heart-red")}else{if("removed" in e){$ico.removeClass("icon-heart-red").addClass("icon-heart")}}$like_count.text(e.likes_count)}})}})}a()});