{% extends 'base.html' %}

{% load staticfiles %}
{% load widget_tweaks %}
{% load i18n %}


{% block before_content %}
    <div class="PageHeader--shop js-headerShareCanvas">
        <div class="wrapper">
            <div class="HeaderShare js-closeHeaderShare">
                <div class="HeaderShare-centeringContainer">
                    <div class="HeaderShare-shareButtons">
                        <a class="js-headerShareButton HeaderShare-Button facebook" target="_blank" data-share-object-type="null" data-share-method="facebook" href="#"></a>
                        <a class="js-headerShareButton HeaderShare-Button twitter" target="_blank" data-share-object-type="null" data-share-method="twitter" href="http://twitter.com/home?status=Shop+Art+%26+Design+Books+on+%40JoinCanopy%3A+https%3A%2F%2Fcanopy.co%2Fshop%2Fart-%26-design-books"></a>
                        <a class="js-headerShareButton HeaderShare-Button pinterest" target="_blank" data-share-object-type="null" data-share-method="pinterest" href="//www.pinterest.com/pin/create/button/?url=https%3A%2F%2Fcanopy.co%2Fshop%2Fart-%26-design-books&amp;media=https://res.cloudinary.com/hcu8jcnmr/image/upload/h_882,w_2004/c_lpad,g_west,w_500,h_630,l_hezl8cabfgokh7u6qn4g,x_126,y_0/c_lpad,g_center,w_500,h_630,l_qrwnronydq5l5xtazrbk,x_0,y_0/c_lpad,g_east,w_500,h_630,l_ooi0v7a1rv9ykrrfnrbr,x_126,y_0/1px_white.jpg&amp;description=Art+%26+Design+Books+on+Canopy"></a>
                        <a class="js-headerShareButton HeaderShare-Button email" data-share-object-type="null" data-share-method="email" href="mailto:?body=Check%20out%20%E2%80%9CShop%3A%20Art%20%26%20Design%20Books%E2%80%9D%20on%20Canopy%3A%0D%0A%0D%0Ahttps%3A%2F%2Fcanopy.co%2Fshop%2Fart-%26-design-books&amp;subject=Shop%20Art%20%26%20Design%20Books%20on%20Canopy"></a>
                    </div>
                    <div class="HeaderShare-closeButtonContainer">
                        <div class="js-closeButtonAnimateTarget" style="opacity: 0">
                            <div class="close-button-base close-button-thin js-closeHeaderShareButton"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="PageHeader-content">
                <div class="PageHeader-categoryName">{{ category.name }}
                </div>
                <div class="PageHeader-actionsContainer">
                    <div class="shareButton">
                        <div class="PillButton--stroked js-triggerHeaderShare">{% trans 'Share' %}</div>
                    </div>
                </div>
            </div>
            <div class="PageHeader-navigationContainer">
                <a class="PillButton--text u-backArrow" href="{{ back_link.1 }}">{{ back_link.0 }}</a>
            </div>
        </div>
    </div>

{% endblock %}

{% block filters_position %}
    <div class="nav-level">
        <div class="nav-level-layout wrapper">
            <div class="PageTabs"></div>
            <div class="page-filters">
                <form class="filter-group" id="filter-form">
                    {% for option in filter_form.order_by %}
                        <label class="filter-link">
                            {{ option.tag }}
                            <span>{{ option.choice_label }}</span>
                        </label>
                    {% endfor %}
                </form>
            </div>
        </div>
    </div>
{% endblock %}


{% block content_class %}
    {{ block.super }} feed-list
{% endblock %}
{% block content %}
    <div id="items">
        {% include page_template %}
    </div>

{% endblock %}


{% block extra_scripts %}
    <script src="{% static 'el-pagination/js/el-pagination.js' %}"></script>
    <script>
        $.endlessPaginate({
            paginateOnScroll: true,
            paginateOnScrollMargin: 300
        });
    </script>
    <script type="text/javascript">

        $(document).ready(function () {

            function submitFilterForm() {
                data = $("#filter-form").serialize();
                $.ajax({
                    data: data,
                    success: function (data) {

                        $("#items").html(data);
                    },
                     error: function () {
                         alert('Извините за доставленные не удобства, попробуйте позже');
                     }
                })
            }
            $(".filter-group input").on("change", function (e) {
                submitFilterForm()
            });

        })
    </script>

{% endblock %}