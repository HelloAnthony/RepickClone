{% extends 'base.html' %}

{% load thumbnail %}
{% load likelist_tags %}
{% load i18n %}

{% block before-content %}

{% endblock %}

{% block content %}
    <div class="ui product-standalone">

        <div class="ui two columns stackable grid">
            <div class="column left-content center aligned">
                {% thumbnail item.main_image "400" crop="center" as im %}
                    <img class="ui centered image" src="{{ im.url }}" alt="{{ item.title }}"><br>
                {% empty %}
                    <p>No image</p>
                {% endthumbnail %}
                <div class="desktop">
                    <div class="small icons social-media-share">
                        <span class="ui mini circular image facebook-share"><i class="facebook icon"></i></span>
                        <span class="ui mini circular image twitter-share"><i class="twitter icon"></i></span>
                        <span class="ui mini circular image pinterest-share"><i class="pinterest icon"></i></span>
                        <a href="mailto:?Subject= Brown Welcome Doormat%20on%20Repick.co&amp;body=https://repick.co/products/1027" target="_top"><span class="ui mini circular image mail-share"><i class="mail icon"></i></span></a>
                    </div>
                </div>
            </div>
            <div class="column right-content">
                <p class="title-text">{{ item.title }}</p>
                <p class="brand-text">{{ item.brand.name }}</p>

                <a class="ui huge blue button price-button" rel="nofollow" target="_blank" href="{{ item.link }}">
                    <span class="button-price"><span class="dollar-sign">$</span>{{ item.get_parse_price.digits }}<span class="decimals">{{ item.get_parse_price.decimal }}</span></span><span class="button-buy-on-amazon">{% trans 'ПОКУПАЙТЕ НА' %} {{ item.get_site_name }}</span>
                </a>

                <br>
                <a class="ui huge white button want-button" id="like-button" href="{% url 'likelist:toggle_like' item.slug %}">
                    <div class="love-this-wrapper-standalone">
                        <i class="heart icon large love-this-icon animated fadeIn{% if item|likelist_exist:request.likelist %} active{% endif %}"></i>
                    </div>
                    <span>LIKE</span>
                </a>
                <div class="editors-note">

                    <p class="description-text">
                        {{ item.description }}
                    </p>
                </div>
                <div class="mobile">
                    <div class="small icons social-media-share">
                        <span class="ui mini circular image facebook-share"><i class="facebook icon"></i></span>
                        <span class="ui mini circular image twitter-share"><i class="twitter icon"></i></span>
                        <span class="ui mini circular image pinterest-share"><i class="pinterest icon"></i></span>
                        <a href="mailto:?Subject= Brown Welcome Doormat%20on%20Repick.co&amp;body=https://repick.co/products/1027" target="_top"><span class="ui mini circular image mail-share"><i class="mail icon"></i></span></a>
                    </div>
                </div>
            </div>
        </div>

        <h3 class="center aligned related-text">RELATED PRODUCTS</h3>

        <div class="related-products">
            {% for rel_item in related_items %}
                <div class="related-product" data-id="{{ rel_item.get_absolute_url }}">
                    {% thumbnail rel_item.main_image "200x200" crop="center" as img %}
                        <img class="ui centered image" src="{{ img.url }}" alt="{{ rel_item.title }}">
                    {% endthumbnail %}
                </div>
            {% endfor %}
        </div>

        <div class="ui stackable two column grid">
            <div class="column big-related-product" data-id="dvE8ezzFAouzJhTYC">
                <img class="ui centered image" src="https://loui.imgix.net/products/CUHZIN5L275fDbdYxbAB.jpg?w=265&amp;h=265&amp;fit=fill&amp;bg=FFFFFF&amp;pad=40" alt="Indoor Outdoor Hello Doormat">
            </div>

            <div class="column big-related-product" data-id="THJ25Ws85aCLbbPh9">
                <img class="ui centered image" src="https://loui.imgix.net/products/g3qqlufaDbshwU7n0rvW.jpg?w=265&amp;h=265&amp;fit=fill&amp;bg=FFFFFF&amp;pad=40" alt="Hi I'm Mat Indoor/Outdoor Doormat">
            </div>

            <div class="column big-related-product" data-id="a4ENFZ9NSLfwMbS34">
                <img class="ui centered image" src="https://loui.imgix.net/ysSX7M0XQqpYMDvd6wvQ.jpg?w=265&amp;h=265&amp;fit=fill&amp;bg=FFFFFF&amp;pad=20" alt="Modern Zoe Desk - White and Chrome">
            </div>

            <div class="column big-related-product" data-id="FmXWFedawT4RNfZJu">
                <img class="ui centered image" src="https://loui.imgix.net/dbDpAFftZFlMrbps5TbG.jpg?w=265&amp;h=265&amp;fit=fill&amp;bg=FFFFFF&amp;pad=40" alt="12-LED Battery Operated Motion Sensing Table Lamp">
            </div>

        </div>

    </div>
{% endblock %}

{% block extra_scripts %}

    <script type="text/javascript">
        $(document).ready(function () {
            $("#like-button").on('click', function (e) {
                e.preventDefault();
                console.log('like-button');
                $btn = $(this);
                var url = $(this).attr('href');
                $.ajax({
                    url: url,
                    contentType: 'application/json',
                    success: function (data) {
                        console.log(data);
                        $icon = $btn.find('.icon');
                        console.log($icon);
                        if('added' in data) {
                            $icon.addClass('active');
                        }
                        else if('removed' in data){
                            $icon.removeClass('active');
                        }
                    }
                })
            })
        })
    </script>
{% endblock %}